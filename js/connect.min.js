function draw_grid(e,t){NUM_ROWS=e;NUM_COLS=t;var n="";for(i=e-1;i>=0;i--){n+="<div class='row' id='row"+i+"'>";for(j=0;j<=t-1;j++){n+="<div class='cell' id='c"+j+"r"+i+"'><img class='square' src='img/square0.png'/></div>"}n+="</div>"}$("#board").html(n);$(".cell").each(function(){$(this).data("player",0)});$("#player").data("player",1);PLAY_BOARD[1][0]=0;PLAY_BOARD[1][1]=0;PLAY_BOARD[2][0]=0;PLAY_BOARD[2][1]=0}function changePlayer(){var e=$("#player").data("player");var t=e==1?2:1;$("#player").data("player",t);$("#pname").text("Player "+t);$("#pnum").toggleClass("player1").toggleClass("player2");CURR_PLAYER=e;$("#c0r0 > img.square").attr("src","img/square"+t+".png");$("#c0r5 > img.square").attr("src","img/square"+t+".png").css("transform","rotate(90deg)");$("#c6r5 > img.square").attr("src","img/square"+t+".png").css("transform","rotate(180deg)");$("#c6r0 > img.square").attr("src","img/square"+t+".png").css("transform","rotate(270deg)")}function setChecker(e,t,n){PLAY_BOARD[n]=setBit64(PLAY_BOARD[n],e,t);animateChecker(t,n)}function checkWin(e){var t=[];var n=[];t=shiftRight64(PLAY_BOARD[e],NUM_ROWS);t=logicalOps64(PLAY_BOARD[e],t,"and");n=shiftRight64(t,2*NUM_ROWS);n=logicalOps64(t,n,"and");if(n[0]|n[1])return true;t=shiftRight64(PLAY_BOARD[e],NUM_COLS);t=logicalOps64(PLAY_BOARD[e],t,"and");n=shiftRight64(t,2*NUM_COLS);n=logicalOps64(t,n,"and");if(n[0]|n[1])return true;t=shiftRight64(PLAY_BOARD[e],NUM_COLS+1);t=logicalOps64(PLAY_BOARD[e],t,"and");n=shiftRight64(t,2*(NUM_COLS+1));n=logicalOps64(t,n,"and");if(n[0]|n[1])return true;t=shiftRight64(PLAY_BOARD[e],1);t=logicalOps64(PLAY_BOARD[e],t,"and");n=shiftRight64(t,2);n=logicalOps64(t,n,"and");if(n[0]|n[1])return true;return false}function findRow(e,t){var n=[];var r;var i;var s=[];var o;r=e*NUM_COLS;n=logicalOps64(PLAY_BOARD[1],PLAY_BOARD[2],"or");s=shiftRight64(n,r);o=s[0];i=Math.pow(2,NUM_ROWS)-1;o=o&i;return Math.log(o+1)/Math.LN2}function animateChecker(e,t){function r(i){var s="#c"+e+"r"+i;var o="#c"+e+"r"+(i+1);var u="#c"+e+"r"+(i-1);if($(s).data("player")==0){$(s).addClass(n,100,"linear");$(o).removeClass(n,100,"linear");i--;if($(u).data("player")==0){window.setTimeout(function(){r(i)},50)}else{$(s).data("player",t);if(checkWin(t)){endGame()}else{changePlayer();$(".cell").click(function(){$(".cell").off("click");id=$(this).attr("id");e=id.substring(1,id.indexOf("r"));var n=findRow(e,t);setChecker(n,e,$("#player").data("player"))})}}}else{alert("That column is full!")}}var n="player"+t;r(NUM_ROWS-1)}function setBit64(e,t,n){var r;var i;var s=[];s[0]=e[0];s[1]=e[1];r=n*(NUM_ROWS+1)+t;i=0;if(r>31){i=1;r=r-32}s[i]=e[i]+Math.pow(2,r);return s}function logicalOps64(e,t,n){var r=[];if(n=="and"){r[0]=e[0]&t[0];r[1]=e[1]&t[1]}else{r[0]=e[0]|t[0];r[1]=e[1]|t[1]}return r}function shiftRight64(e,t){var n;var r=[];if(t<32){r[0]=e[0]>>>t;n=e[1]&Math.pow(2,t)-1;r[0]=r[0]|n<<32-t;r[1]=e[1]>>>t}else{r[0]=e[1]>>>t-32;r[1]=0}return r}function endGame(){var e=CURR_PLAYER==1?2:1;if(confirm("Player "+e+" wins! New game?")){draw_grid(6,7);$(".cell").click(function(){$(".cell").off("click");id=$(this).attr("id");column=id.substring(1,id.indexOf("r"));var t=findRow(column,e);setChecker(t,column,$("#player").data("player"))})}else{alert("You pressed Cancel! We should redirect...somewhere...Kansas?")}}function displayTabs(){var e=$("div.tabPanel > div");$("div.tabPanel ul.tabs a").click(function(){e.hide().filter(this.hash).show();$("div.tabPanel ul.tabs a").removeClass("selected");$(this).addClass("selected");return false}).filter(":first").click()}var PLAY_BOARD={1:{0:0,1:0},2:{0:0,1:0}};var CURR_PLAYER=1;var NUM_COLS=7;var NUM_ROWS=6